---
- name: Procurar AssinadorARISP.exe na pasta Downloads
  hosts: windows  # Ou o nome do seu grupo de hosts adequado
  tasks:
    - name: Procurar caminho da pasta Downloads
      win_shell: |
        $shell = New-Object -ComObject Shell.Application
        $downloads = $shell.Namespace('shell:::{374DE290-123F-4565-9164-39C4925E467B}').Self.Path
        $downloads
      register: downloads_folder

    - name: Procurar AssinadorARISP.exe na pasta Downloads
      win_find:
        paths: "{{ downloads_folder.stdout }}"  # Usando o caminho obtido do PowerShell
        patterns: "AssinadorARISP.exe"
        recurse: yes
      register: found_files

    - name: Exibir arquivos encontrados
      debug:
        msg: "Arquivos encontrados: {{ found_files.files }}"
